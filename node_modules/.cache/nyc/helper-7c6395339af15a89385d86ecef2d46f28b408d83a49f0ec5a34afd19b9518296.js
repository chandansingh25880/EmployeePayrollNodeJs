function cov_i3qhfovb(){var path="F:\\Node-Project\\EmployeePayrollNodeJs\\app\\middleware\\helper.js";var hash="d0b206d3336de3a405a657c908578d7476b1ab67";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"F:\\Node-Project\\EmployeePayrollNodeJs\\app\\middleware\\helper.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:40}},"1":{start:{line:2,column:15},end:{line:2,column:32}},"2":{start:{line:3,column:12},end:{line:3,column:35}},"3":{start:{line:12,column:20},end:{line:15,column:5}},"4":{start:{line:13,column:20},end:{line:13,column:91}},"5":{start:{line:14,column:8},end:{line:14,column:39}},"6":{start:{line:22,column:20},end:{line:24,column:5}},"7":{start:{line:23,column:8},end:{line:23,column:105}},"8":{start:{line:30,column:17},end:{line:51,column:5}},"9":{start:{line:31,column:20},end:{line:31,column:44}},"10":{start:{line:32,column:8},end:{line:50,column:9}},"11":{start:{line:33,column:12},end:{line:33,column:35}},"12":{start:{line:34,column:12},end:{line:43,column:15}},"13":{start:{line:35,column:16},end:{line:42,column:17}},"14":{start:{line:36,column:20},end:{line:39,column:23}},"15":{start:{line:41,column:20},end:{line:41,column:27}},"16":{start:{line:46,column:12},end:{line:49,column:15}},"17":{start:{line:53,column:0},end:{line:53,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:20},end:{line:12,column:21}},loc:{start:{line:12,column:44},end:{line:15,column:5}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:20},end:{line:22,column:21}},loc:{start:{line:22,column:53},end:{line:24,column:5}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:30,column:17},end:{line:30,column:18}},loc:{start:{line:30,column:37},end:{line:51,column:5}},line:30},"3":{name:"(anonymous_3)",decl:{start:{line:34,column:51},end:{line:34,column:52}},loc:{start:{line:34,column:58},end:{line:43,column:13}},line:34}},branchMap:{"0":{loc:{start:{line:14,column:15},end:{line:14,column:38}},type:"cond-expr",locations:[{start:{line:14,column:26},end:{line:14,column:30}},{start:{line:14,column:33},end:{line:14,column:38}}],line:14},"1":{loc:{start:{line:23,column:15},end:{line:23,column:104}},type:"cond-expr",locations:[{start:{line:23,column:49},end:{line:23,column:96}},{start:{line:23,column:99},end:{line:23,column:104}}],line:23},"2":{loc:{start:{line:23,column:16},end:{line:23,column:45}},type:"binary-expr",locations:[{start:{line:23,column:16},end:{line:23,column:28}},{start:{line:23,column:32},end:{line:23,column:45}}],line:23},"3":{loc:{start:{line:32,column:8},end:{line:50,column:9}},type:"if",locations:[{start:{line:32,column:8},end:{line:50,column:9}},{start:{line:32,column:8},end:{line:50,column:9}}],line:32},"4":{loc:{start:{line:35,column:16},end:{line:42,column:17}},type:"if",locations:[{start:{line:35,column:16},end:{line:42,column:17}},{start:{line:35,column:16},end:{line:42,column:17}}],line:35}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d0b206d3336de3a405a657c908578d7476b1ab67"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_i3qhfovb=function(){return actualCoverage;};}return actualCoverage;}cov_i3qhfovb();const{sign}=(cov_i3qhfovb().s[0]++,require('jsonwebtoken'));const bcrypt=(cov_i3qhfovb().s[1]++,require('bcrypt'));const jwt=(cov_i3qhfovb().s[2]++,require("jsonwebtoken"));class Helper{/*
    * @description this method is used to generate JWT Token 
    * @param data->emailId, timelimit for the Token 
    * @return token
    */generateToken=(cov_i3qhfovb().s[3]++,(emailId,timeLimit)=>{cov_i3qhfovb().f[0]++;let token=(cov_i3qhfovb().s[4]++,sign({email:emailId},process.env.JWT_KEY,{expiresIn:timeLimit}));cov_i3qhfovb().s[5]++;return!token?(cov_i3qhfovb().b[0][0]++,null):(cov_i3qhfovb().b[0][1]++,token);});/*
    * @description this method is used to checkpassword
    * @param userPassword from body, encryptedPassword from Database
    * @return boolen value
    */checkPassword=(cov_i3qhfovb().s[6]++,(Userpassword,encryptedPass)=>{cov_i3qhfovb().f[1]++;cov_i3qhfovb().s[7]++;return(cov_i3qhfovb().b[2][0]++,Userpassword)&&(cov_i3qhfovb().b[2][1]++,encryptedPass)?(cov_i3qhfovb().b[1][0]++,bcrypt.compareSync(Userpassword,encryptedPass)):(cov_i3qhfovb().b[1][1]++,false);});/*
    * @description CheckToken method is used to validate the Token before the execution of next
    * @param req from the user, res to server , next method 
    */checkToken=(cov_i3qhfovb().s[8]++,(req,res,next)=>{cov_i3qhfovb().f[2]++;let token=(cov_i3qhfovb().s[9]++,req.get("authorization"));cov_i3qhfovb().s[10]++;if(token){cov_i3qhfovb().b[3][0]++;cov_i3qhfovb().s[11]++;token=token.slice(7);cov_i3qhfovb().s[12]++;jwt.verify(token,process.env.JWT_KEY,err=>{cov_i3qhfovb().f[3]++;cov_i3qhfovb().s[13]++;if(err){cov_i3qhfovb().b[4][0]++;cov_i3qhfovb().s[14]++;return res.status(400).send({success:false,message:"Invalid Token or Expired"});}else{cov_i3qhfovb().b[4][1]++;cov_i3qhfovb().s[15]++;next();}});}else{cov_i3qhfovb().b[3][1]++;cov_i3qhfovb().s[16]++;return res.status(401).send({success:false,message:"Access Denied!!!..Unauthorized User! add Token and then Proceed "});}});}cov_i3qhfovb().s[17]++;module.exports=new Helper();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhlbHBlci5qcyJdLCJuYW1lcyI6WyJzaWduIiwicmVxdWlyZSIsImJjcnlwdCIsImp3dCIsIkhlbHBlciIsImdlbmVyYXRlVG9rZW4iLCJlbWFpbElkIiwidGltZUxpbWl0IiwidG9rZW4iLCJlbWFpbCIsInByb2Nlc3MiLCJlbnYiLCJKV1RfS0VZIiwiZXhwaXJlc0luIiwiY2hlY2tQYXNzd29yZCIsIlVzZXJwYXNzd29yZCIsImVuY3J5cHRlZFBhc3MiLCJjb21wYXJlU3luYyIsImNoZWNrVG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwiZ2V0Iiwic2xpY2UiLCJ2ZXJpZnkiLCJlcnIiLCJzdGF0dXMiLCJzZW5kIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiMjBHQWVZO3VGQWZaLEtBQU0sQ0FBRUEsSUFBRix5QkFBV0MsT0FBTyxDQUFDLGNBQUQsQ0FBbEIsQ0FBTixDQUNBLEtBQU1DLENBQUFBLE1BQU0sd0JBQUdELE9BQU8sQ0FBQyxRQUFELENBQVYsQ0FBWixDQUNBLEtBQU1FLENBQUFBLEdBQUcsd0JBQUdGLE9BQU8sQ0FBQyxjQUFELENBQVYsQ0FBVCxDQUVBLEtBQU1HLENBQUFBLE1BQU8sQ0FFVDtBQUNKO0FBQ0E7QUFDQTtBQUNBLE1BQ0lDLGFBQWEsd0JBQUcsQ0FBQ0MsT0FBRCxDQUFVQyxTQUFWLEdBQXdCLHVCQUNwQyxHQUFJQyxDQUFBQSxLQUFLLHdCQUFHUixJQUFJLENBQUMsQ0FBRVMsS0FBSyxDQUFFSCxPQUFULENBQUQsQ0FBcUJJLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxPQUFqQyxDQUEwQyxDQUFFQyxTQUFTLENBQUVOLFNBQWIsQ0FBMUMsQ0FBUCxDQUFULENBRG9DLHNCQUVwQyxNQUFRLENBQUNDLEtBQUYsMkJBQVcsSUFBWCw0QkFBa0JBLEtBQWxCLENBQVAsQ0FDSCxDQUhZLEVBS2I7QUFDSjtBQUNBO0FBQ0E7QUFDQSxNQUNJTSxhQUFhLHdCQUFHLENBQUNDLFlBQUQsQ0FBZUMsYUFBZixHQUFpQyw2Q0FDN0MsTUFBUSwwQkFBQUQsWUFBWSw2QkFBSUMsYUFBSixDQUFiLDJCQUFrQ2QsTUFBTSxDQUFDZSxXQUFQLENBQW1CRixZQUFuQixDQUFpQ0MsYUFBakMsQ0FBbEMsNEJBQW9GLEtBQXBGLENBQVAsQ0FDSCxDQUZZLEVBSWI7QUFDSjtBQUNBO0FBQ0EsTUFDSUUsVUFBVSx3QkFBRyxDQUFDQyxHQUFELENBQU1DLEdBQU4sQ0FBV0MsSUFBWCxHQUFvQix1QkFDN0IsR0FBSWIsQ0FBQUEsS0FBSyx3QkFBR1csR0FBRyxDQUFDRyxHQUFKLENBQVEsZUFBUixDQUFILENBQVQsQ0FENkIsdUJBRTdCLEdBQUlkLEtBQUosQ0FBVyxpREFDUEEsS0FBSyxDQUFHQSxLQUFLLENBQUNlLEtBQU4sQ0FBWSxDQUFaLENBQVIsQ0FETyx1QkFFUHBCLEdBQUcsQ0FBQ3FCLE1BQUosQ0FBV2hCLEtBQVgsQ0FBa0JFLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxPQUE5QixDQUF1Q2EsR0FBRyxFQUFJLDhDQUMxQyxHQUFJQSxHQUFKLENBQVMsaURBQ0wsTUFBT0wsQ0FBQUEsR0FBRyxDQUFDTSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsQ0FDeEJDLE9BQU8sQ0FBRSxLQURlLENBRXhCQyxPQUFPLENBQUUsMEJBRmUsQ0FBckIsQ0FBUCxDQUlILENBTEQsSUFLTyxpREFDSFIsSUFBSSxHQUNQLENBQ0osQ0FURCxFQVVILENBWkQsSUFhSyxpREFDRCxNQUFPRCxDQUFBQSxHQUFHLENBQUNNLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixDQUN4QkMsT0FBTyxDQUFFLEtBRGUsQ0FFeEJDLE9BQU8sQ0FBRSxrRUFGZSxDQUFyQixDQUFQLENBSUgsQ0FDSixDQXJCUyxFQXpCRCxDLHVCQWdEYkMsTUFBTSxDQUFDQyxPQUFQLENBQWlCLEdBQUkzQixDQUFBQSxNQUFKLEVBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBzaWduIH0gPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKTtcclxuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0Jyk7XHJcbmNvbnN0IGp3dCA9IHJlcXVpcmUoXCJqc29ud2VidG9rZW5cIik7XHJcblxyXG5jbGFzcyBIZWxwZXIge1xyXG5cclxuICAgIC8qXHJcbiAgICAqIEBkZXNjcmlwdGlvbiB0aGlzIG1ldGhvZCBpcyB1c2VkIHRvIGdlbmVyYXRlIEpXVCBUb2tlbiBcclxuICAgICogQHBhcmFtIGRhdGEtPmVtYWlsSWQsIHRpbWVsaW1pdCBmb3IgdGhlIFRva2VuIFxyXG4gICAgKiBAcmV0dXJuIHRva2VuXHJcbiAgICAqL1xyXG4gICAgZ2VuZXJhdGVUb2tlbiA9IChlbWFpbElkLCB0aW1lTGltaXQpID0+IHtcclxuICAgICAgICBsZXQgdG9rZW4gPSBzaWduKHsgZW1haWw6IGVtYWlsSWQgfSwgcHJvY2Vzcy5lbnYuSldUX0tFWSwgeyBleHBpcmVzSW46IHRpbWVMaW1pdCB9KTtcclxuICAgICAgICByZXR1cm4gKCF0b2tlbikgPyBudWxsIDogdG9rZW47XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgICogQGRlc2NyaXB0aW9uIHRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gY2hlY2twYXNzd29yZFxyXG4gICAgKiBAcGFyYW0gdXNlclBhc3N3b3JkIGZyb20gYm9keSwgZW5jcnlwdGVkUGFzc3dvcmQgZnJvbSBEYXRhYmFzZVxyXG4gICAgKiBAcmV0dXJuIGJvb2xlbiB2YWx1ZVxyXG4gICAgKi9cclxuICAgIGNoZWNrUGFzc3dvcmQgPSAoVXNlcnBhc3N3b3JkLCBlbmNyeXB0ZWRQYXNzKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIChVc2VycGFzc3dvcmQgJiYgZW5jcnlwdGVkUGFzcykgPyBiY3J5cHQuY29tcGFyZVN5bmMoVXNlcnBhc3N3b3JkLCBlbmNyeXB0ZWRQYXNzKSA6IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICAqIEBkZXNjcmlwdGlvbiBDaGVja1Rva2VuIG1ldGhvZCBpcyB1c2VkIHRvIHZhbGlkYXRlIHRoZSBUb2tlbiBiZWZvcmUgdGhlIGV4ZWN1dGlvbiBvZiBuZXh0XHJcbiAgICAqIEBwYXJhbSByZXEgZnJvbSB0aGUgdXNlciwgcmVzIHRvIHNlcnZlciAsIG5leHQgbWV0aG9kIFxyXG4gICAgKi9cclxuICAgIGNoZWNrVG9rZW4gPSAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgICAgICBsZXQgdG9rZW4gPSByZXEuZ2V0KFwiYXV0aG9yaXphdGlvblwiKTtcclxuICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgdG9rZW4gPSB0b2tlbi5zbGljZSg3KTtcclxuICAgICAgICAgICAgand0LnZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX0tFWSwgZXJyID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJJbnZhbGlkIFRva2VuIG9yIEV4cGlyZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKHtcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJBY2Nlc3MgRGVuaWVkISEhLi5VbmF1dGhvcml6ZWQgVXNlciEgYWRkIFRva2VuIGFuZCB0aGVuIFByb2NlZWQgXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbm1vZHVsZS5leHBvcnRzID0gbmV3IEhlbHBlcigpOyJdfQ==